# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (Breaking Changes)

> –°–ø–∏—Å–æ–∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å Photino –Ω–∞ Avalonia UI (PR #299).

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä](#-–æ–±–∑–æ—Ä)
- [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è](#-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–∏–∑–º–µ–Ω–µ–Ω–∏—è)
  - [–£–¥–∞–ª–µ–Ω–∏–µ Frontend –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏](#1-—É–¥–∞–ª–µ–Ω–∏–µ-frontend-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
  - [–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ Backend ‚Üí Services](#2-–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ-backend--services)
  - [Dependency Injection](#3-dependency-injection)
  - [–ò–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏](#4-–∏–∑–º–µ–Ω–µ–Ω–∏—è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
  - [–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è](#5-–ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è)
  - [–ü—É—Ç—å –∫ —Ä–µ—Å—É—Ä—Å–∞–º](#6-–ø—É—Ç—å-–∫-—Ä–µ—Å—É—Ä—Å–∞–º)
  - [ViewModels](#7-viewmodels)
  - [–ö–æ–º–∞–Ω–¥—ã](#8-–∫–æ–º–∞–Ω–¥—ã)
  - [–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ](#9-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
  - [–ò–∫–æ–Ω–∫–∏ UI](#10-–∏–∫–æ–Ω–∫–∏-ui)
- [–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã](#-–≤–æ–∑–º–æ–∂–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã)
- [–°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏](#-—Å–∫—Ä–∏–ø—Ç-–º–∏–≥—Ä–∞—Ü–∏–∏)

---

## üìã –û–±–∑–æ—Ä

–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Avalonia UI –≤–∫–ª—é—á–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞:
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–æ—Ä–∫–∏
- –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –°–∫—Ä–∏–ø—Ç—ã —Å–±–æ—Ä–∫–∏
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

---

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –£–¥–∞–ª–µ–Ω–∏–µ Frontend –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

**–ë—ã–ª–æ:** `frontend/` ‚Äî TypeScript/React SPA  
**–°—Ç–∞–ª–æ:** –£–¥–∞–ª–µ–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é

**–í–ª–∏—è–Ω–∏–µ:**
- –í—Å–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ JS/TS –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã
- –ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ UI –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–π

**–ú–∏–≥—Ä–∞—Ü–∏—è:**
- –ò–∑—É—á–∏—Ç–µ `UI/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
- –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ Avalonia XAML
- –°–º. [UIComponentGuide.md](../Development/UIComponentGuide.md)

---

### 2. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ Backend ‚Üí Services

**–ë—ã–ª–æ:** `Backend/AppService.cs` ‚Äî –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å  
**–°—Ç–∞–ª–æ:** `Services/` ‚Äî –º–æ–¥—É–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

**–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**

```diff
- Backend/
-   AppService.cs
-   AuthService.cs
-   ClientPatcher.cs
+ Services/
+   Core/
+     ConfigService.cs
+     LocalizationService.cs
+     Logger.cs
+   Game/
+     GameSessionService.cs
+     LaunchService.cs
+     ClientPatcher.cs
+   User/
+     ProfileService.cs
+     SkinService.cs
```

**–ú–∏–≥—Ä–∞—Ü–∏—è:**
- –û–±–Ω–æ–≤–∏—Ç–µ imports
- `AppService` —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º
- –°–º. [ServicesReference.md](ServicesReference.md)

---

### 3. Dependency Injection

**–ë—ã–ª–æ:** –ü—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤  
**–°—Ç–∞–ª–æ:** DI —á–µ—Ä–µ–∑ `Bootstrapper.cs`

```csharp
// ‚ùå –°—Ç–∞—Ä—ã–π –∫–æ–¥ (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
var appService = new AppService();

// ‚úÖ –ù–æ–≤—ã–π –∫–æ–¥
public class MyClass
{
    public MyClass(GameSessionService gameService) { }
}

// –ò–ª–∏ —á–µ—Ä–µ–∑ ServiceProvider
var service = App.Current.Services!.GetRequiredService<GameSessionService>();
```

**–ú–∏–≥—Ä–∞—Ü–∏—è:**
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ —Å–µ—Ä–≤–∏—Å—ã –≤ `Bootstrapper.cs`
- –ü–æ–ª—É—á–∞–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

---

### 4. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–ë—ã–ª–æ:** `settings.json`  
**–°—Ç–∞–ª–æ:** `config.json`

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –ø–æ–ª—è:**

| –°—Ç–∞—Ä–æ–µ –ø–æ–ª–µ | –ù–æ–≤–æ–µ –ø–æ–ª–µ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-------------|------------|------------|
| `GamePath` | ‚Äî | –£–¥–∞–ª–µ–Ω–æ (Instances —É–ø—Ä–∞–≤–ª—è–µ—Ç) |
| `Theme` | ‚Äî | –£–¥–∞–ª–µ–Ω–æ (—Ç–æ–ª—å–∫–æ —Ç—ë–º–Ω–∞—è —Ç–µ–º–∞) |
| `JavaArgs` | ‚Äî | –£–¥–∞–ª–µ–Ω–æ |
| ‚Äî | `VersionType` | –î–æ–±–∞–≤–ª–µ–Ω–æ (`release`/`pre-release`) |
| ‚Äî | `AccentColor` | –î–æ–±–∞–≤–ª–µ–Ω–æ (HEX —Ü–≤–µ—Ç) |
| `Language` | `Language` | –§–æ—Ä–º–∞—Ç –∏–∑–º–µ–Ω—ë–Ω |

**–§–æ—Ä–º–∞—Ç Language:**

```diff
- "Language": "English"
+ "Language": "en-US"
```

**–ú–∏–≥—Ä–∞—Ü–∏—è:**
- –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π `config.json` –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–æ–¥–µ–ª–∏ `Models/Config.cs`
- –ò–ª–∏ —É–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–π ‚Äî –æ–Ω –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

### 5. –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

**–ë—ã–ª–æ:** `assets/game-lang/{CODE}/client.lang` ‚Äî –∫–∞—Å—Ç–æ–º–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç  
**–°—Ç–∞–ª–æ:** `Assets/Locales/{code}.json` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π JSON

**–§–æ—Ä–º–∞—Ç:**

```diff
- # –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç (.lang)
- Buttons.Play=Play Game
- Buttons.Settings=Settings

+ // –ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç (.json)
+ {
+   "_langName": "English",
+   "_langCode": "en-US",
+   "button": {
+     "play": "Play",
+     "settings": "Settings"
+   }
+ }
```

**–ú–∏–≥—Ä–∞—Ü–∏—è:**
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ `.lang` –≤ `.json`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–ª–æ–∂–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–ª—é—á–µ–π

---

### 6. –ü—É—Ç—å –∫ Assets

**–ë—ã–ª–æ:** `assets/` (lowercase)  
**–°—Ç–∞–ª–æ:** `Assets/` (PascalCase)

```diff
- assets/icons/play.svg
+ Assets/Icons/play.svg
```

**–ú–∏–≥—Ä–∞—Ü–∏—è:**
- –û–±–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –ø—É—Ç–∏ –≤ –∫–æ–¥–µ
- –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ —Ä–µ—Å—É—Ä—Å—ã –≤ `Assets/`

---

### 7. ViewModels

**–ë—ã–ª–æ:** –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ `ViewModelBase`  
**–°—Ç–∞–ª–æ:** –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç `ReactiveObject`

```csharp
// ‚ùå –°—Ç–∞—Ä—ã–π –∫–æ–¥
public class MyViewModel : ViewModelBase
{
    private string _name;
    public string Name
    {
        get => _name;
        set => SetProperty(ref _name, value);
    }
}

// ‚úÖ –ù–æ–≤—ã–π –∫–æ–¥
public partial class MyViewModel : ReactiveObject
{
    [ObservableProperty]
    private string _name;
}
```

**–ú–∏–≥—Ä–∞—Ü–∏—è:**
- –ó–∞–º–µ–Ω–∏—Ç–µ –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –Ω–∞ `ReactiveObject`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `[ObservableProperty]` –∞—Ç—Ä–∏–±—É—Ç—ã
- –î–æ–±–∞–≤—å—Ç–µ `partial` –∫ –∫–ª–∞—Å—Å—É

---

### 8. –ö–æ–º–∞–Ω–¥—ã

**–ë—ã–ª–æ:** –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ `ICommand`  
**–°—Ç–∞–ª–æ:** `[RelayCommand]` –∞—Ç—Ä–∏–±—É—Ç

```csharp
// ‚ùå –°—Ç–∞—Ä—ã–π –∫–æ–¥
public ICommand PlayCommand { get; }
public MyViewModel()
{
    PlayCommand = new RelayCommand(Play);
}

// ‚úÖ –ù–æ–≤—ã–π –∫–æ–¥
[RelayCommand]
private void Play()
{
    // ...
}
// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è PlayCommand –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

---

### 9. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ë—ã–ª–æ:** `Logger.Log("message")`  
**–°—Ç–∞–ª–æ:** `Logger.Info("category", "message")`

```csharp
// ‚ùå –°—Ç–∞—Ä—ã–π –∫–æ–¥
Logger.Log("Starting download");

// ‚úÖ –ù–æ–≤—ã–π –∫–æ–¥
Logger.Info("Download", "Starting download");
Logger.Success("Download", "Completed");
Logger.Error("Download", "Failed");
```

---

### 10. UI –ò–∫–æ–Ω–∫–∏

**–ë—ã–ª–æ:** `<Image Source="...">`  
**–°—Ç–∞–ª–æ:** `<svg:Svg Path="...">`

```xml
<!-- ‚ùå –°—Ç–∞—Ä—ã–π –∫–æ–¥ -->
<Image Source="/assets/icons/play.png"/>

<!-- ‚úÖ –ù–æ–≤—ã–π –∫–æ–¥ -->
<svg:Svg Path="/Assets/Icons/play.svg" Width="24" Height="24"/>
```

---

## ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ö–æ–º–ø–∏–ª—è—Ü–∏–∏

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|---------|
| `CS0246: AppService not found` | –£–¥–∞–ª—ë–Ω | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã |
| `CS0246: ViewModelBase not found` | –£–¥–∞–ª—ë–Ω | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `ReactiveObject` |
| `File not found: assets/` | –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ | –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ `Assets/` |

### Runtime

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|---------|
| `InvalidOperationException: Service not registered` | DI –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω | –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –≤ `Bootstrapper.cs` |
| `FileNotFoundException: config.json` | –§–æ—Ä–º–∞—Ç –∏–∑–º–µ–Ω—ë–Ω | –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª |

---

## üîß –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π:

```bash
# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ assets ‚Üí Assets
mv assets Assets 2>/dev/null || true

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤
rm -f settings.json auth.json

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞
dotnet clean
dotnet build
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [MigrationGuide.md](MigrationGuide.md) ‚Äî –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏
- [Architecture.md](Architecture.md) ‚Äî –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [ServicesReference.md](ServicesReference.md) ‚Äî –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
