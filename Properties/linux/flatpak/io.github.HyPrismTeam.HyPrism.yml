app-id: io.github.HyPrismTeam.HyPrism
runtime: org.freedesktop.Platform
runtime-version: '25.08'
sdk: org.freedesktop.Sdk
base: org.electronjs.Electron2.BaseApp
base-version: '25.08'
command: hyprism-launcher-wrapper

sdk-extensions:
  - org.freedesktop.Sdk.Extension.node22

add-extensions:
  org.freedesktop.Platform.codecs_extra.i386:
    directory: lib/i386-linux-gnu/codecs-extra
    version: '25.08-extra'
    autodelete: false
    add-ld-path: lib
      
build-options:
  append-path: /usr/lib/sdk/node22/bin

finish-args:
  - --share=ipc
  - --socket=fallback-x11
  - --socket=pulseaudio
  - --share=network
  - --device=dri
  - --talk-name=org.freedesktop.Notifications
  - --env=LD_LIBRARY_PATH=/app/lib
  - --env=ELECTRON_TRASH=gio
  - --env=XCURSOR_PATH=/run/host/user-share/icons:/run/host/share/icons

modules:

  - name: HyPrism
    buildsystem: simple
    build-commands:
      - mkdir -p /app/lib/i386-linux-gnu/codecs-extra
      - install -d /app/HyPrism
      - cp -R linux-unpacked/* /app/HyPrism
      - chmod +x /app/HyPrism/chrome-sandbox /app/HyPrism/HyPrism
      - cp -R wwwroot /app/wwwroot
      - install -Dm755 hyprism-launcher-wrapper.sh /app/bin/hyprism-launcher-wrapper
      - install -Dm644 io.github.HyPrismTeam.HyPrism.png /app/share/icons/hicolor/256x256/apps/io.github.HyPrismTeam.HyPrism.png
      - install -Dm644 io.github.HyPrismTeam.HyPrism.desktop /app/share/applications/io.github.HyPrismTeam.HyPrism.desktop
      - install -Dm644 io.github.HyPrismTeam.HyPrism.metainfo.xml /app/share/metainfo/io.github.HyPrismTeam.HyPrism.metainfo.xml
      - ln -s /app/HyPrism/HyPrism /app/bin/HyPrism
    sources:
      - type: dir
        path: ../../../bin/Release/net10.0/linux-x64/publish/linux-unpacked
        dest: linux-unpacked
      - type: dir
        path: ../../../wwwroot
        dest: wwwroot
      - type: file
        path: hyprism-launcher-wrapper.sh
      - type: file
        path: io.github.HyPrismTeam.HyPrism.png
      - type: file
        path: hyprism-launcher-wrapper.sh
      - type: file
        path: io.github.HyPrismTeam.HyPrism.desktop
      - type: file
        path: io.github.HyPrismTeam.HyPrism.metainfo.xml
